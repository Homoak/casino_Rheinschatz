<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Registration</title>
    <link rel="stylesheet" href="../static/css/register.css">
</head>
<body>
    <div class="first_content">
        <font style="color: white;" face="Arial">
            <h1 class="image-text" align="center" style="color:white">Hello! It is registration!</h1>
            <form id="registrationForm" action="{{ url_for('register') }}" method="post" class="form">
                <h2 align="center" class="form_title" style="color:white">Register</h2>
                <div class="form_group">
                    <input onChange="checkForm()" id="name" name="name" class="form_input" type="text" placeholder="Name">
                </div>
                <div class="form_group">
                    <input onChange="checkForm()" id="email" name="email" class="form_input" type="text" placeholder="Email">
                </div>
                <div class="form_group">
                    <input onChange="checkForm()" id="password" name="password" class="form_input" type="password" placeholder="Password">
                </div>
                <div class="form_group">
                    <input onChange="checkForm()" id="repl_password" name="repl_password" class="form_input" type="password" placeholder="Replay_Password">
                </div>
                <div class="logo">
                    <img src="../static/images/logo.webp" alt="Логотип">
                </div>
                <div class="button-container">
                    <button onclick="play(); setTimeout(function() { location.href='http://127.0.0.1:7777/'; }, 500);" class="casino-button" type="button" formtarget="_blank">Back</button>
                    <button id="submitButton" class="casino-button" type="submit" disabled>Enter</button>

                </div>
            </form>
        </font>
    </div>

    <div class="second_content">
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        {% for category, message in messages %}
        <div class="flash-message {{ category }}">{{ message }}</div>
        {% endfor %}
        {% endif %}
        {% endwith %}
    </div>

    <script>
document.addEventListener("DOMContentLoaded", function() {
    const nameInput = document.getElementById('name');
    const emailInput = document.getElementById('email');
    const passwordInput = document.getElementById('password');
    const replPasswordInput = document.getElementById('repl_password');
    const submitButton = document.getElementById('submitButton');

    // Функція для перевірки форми
    function checkForm() {
        const name = nameInput.value.trim();
        const email = emailInput.value.trim();
        const password = passwordInput.value.trim();
        const replPassword = replPasswordInput.value.trim();

        // Перевірка на заповненість полів та співпадіння паролів
        if (name && email && password && replPassword && password === replPassword) {
            submitButton.disabled = false; // Активувати кнопку, якщо всі умови виконано
        } else {
            submitButton.disabled = true; // Інакше залишити кнопку неактивною
        }
    }

    // Додаємо слухачів на кожне поле вводу
    [nameInput, emailInput, passwordInput, replPasswordInput].forEach(input => {
        input.addEventListener('input', checkForm);
    });

    // Початкова перевірка форми при завантаженні сторінки
    checkForm();

    // Відправка форми з анімацією при натисканні на кнопку
    submitButton.addEventListener('click', function(event) {
        if (!submitButton.disabled) {
            event.preventDefault(); // Запобігання стандартній поведінці для початку
            const audio = document.getElementById('audio');
            if (audio) {
                audio.play().then(() => {
                    document.getElementById('registrationForm').submit();
                }).catch(error => {
                    console.error('Не вдалося програти аудіо:', error);
                    document.getElementById('registrationForm').submit(); // Відправка форми у разі помилки аудіо
                });
            } else {
                document.getElementById('registrationForm').submit(); // Якщо нема аудіо, відправляємо форму відразу
            }
        }
    });

    // Виведення повідомлень Flash (якщо є)
    const messages = document.querySelectorAll('.flash-message');
    messages.forEach(function(message) {
        setTimeout(function() {
            message.classList.add('visible');
        }, 100);
        setTimeout(function() {
            message.classList.add('hidden');
            setTimeout(function() {
                message.remove();
            }, 1000);
        }, 5000);
    });
});
    </script>
</body>
</html>
